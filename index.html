<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Web Page</title>
    <style>
        /* Add CSS styles for the grid layout */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(4, 25%); /* 2 rows and 4 columns with 25% width */
            grid-gap: 1px; /* Adjust the gap between frames as needed */
        }

        .iframe-container {
            position: relative;
            width: 100%;
            padding-top: 100%; /* 1:1 aspect ratio (100% of width) */
        }

        .iframe-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .frame-label {
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Your HTML content here -->

    <!-- Include the JavaScript code within script tags -->
    <script>
        var finishedJobs = [];
        var axoUrl = "https://hosted.ntent.art/projects/axo/index.html";

        // Count the number of frames you create
        var frameCount = 0;

        // First we set up an event listener to listen for messages from all iframes
        // This allows us to communicate more effectively, with the name and tokenId
        window.addEventListener(
            "message",
            (e) => {
                // Handle the message
                if (typeof e.data === "object" && e.data.event == "axoReady") {
                    var iframe = document.getElementById(e.data.value);
                    console.log(
                        `${e.data.value} is ready. Token Id : ${e.data.tokenId}`
                    );
                    iframe.tokenId = e.data.tokenId;
                }
            },
            false
        );

        // you can curate via the query string
        var cmds = [
            { action: "F", value: true, frame: 87 },
            { action: "P", value: true, frame: 154 },
            { action: "P", value: false, frame: 469 },
            { action: "F", value: false, frame: 552 },
            { action: "A", value: true, frame: 628 },
            { action: "F", value: true, frame: 770 },
            { action: "P", value: true, frame: 819 },
            { action: "P", value: false, frame: 1079 },
        ];

        var scale = 5;
        var robotCount = 8; // Adjust the number of frames as needed

        // Create a grid container to hold the frames
        var gridContainer = document.createElement("div");
        gridContainer.classList.add("grid-container");
        document.body.appendChild(gridContainer);

        createIframe(
            "olivia",
            "Olivia Dunham",
            axoUrl + "?z=3&w=" +
            JSON.stringify(cmds)
        );

        createIframe(
            "dick",
            "Dick Whitman",
            axoUrl + "?z=" + scale
        );

        createIframe(
            "sebastian",
            "Lil Sebastian",
            axoUrl + "?z=" + scale
        );

        for (var i = 0; i < robotCount; i++) {
            createIframe(
                "robot" + (i + 1).toString(),
                "Robot " + (i + 1),
                axoUrl + "?z=" + scale
            );
        }

        // Display the total number of frames created
        console.log(`Total frames created: ${frameCount}`);

        function createIframe(id, label, url) {
            var container = document.createElement("div");
            container.classList.add("iframe-container");
            var iframe = document.createElement("iframe");
            iframe.id = id;
            iframe.onload = () => {
                var frame = document.getElementById(id);
                frame.contentWindow.postMessage({ event: "hello", value: id }, "*");
            };
            iframe.src = url;
            container.appendChild(iframe);

            // Add frame label
            var labelDiv = document.createElement("div");
            labelDiv.classList.add("frame-label");
            labelDiv.innerHTML = label;
            container.appendChild(labelDiv);

            gridContainer.appendChild(container);

            // Increment the frame count
            frameCount++;
        }
    </script>
</body>
</html>
